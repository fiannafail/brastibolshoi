{"version":3,"sources":["webpack:///webpack/bootstrap f8bf1967b17499046a72","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"debug\"","webpack:///./server/config.js","webpack:///./server/handlers/redis.js","webpack:///./server/models/user.js","webpack:///external \"mongoose\"","webpack:///external \"redis\"","webpack:///external \"koa-passport\"","webpack:///./server/services/jwt-service.js","webpack:///external \"sequelize\"","webpack:///./server/postgres-connector.js","webpack:///external \"jsonwebtoken\"","webpack:///./nuxt.config.js","webpack:///./server/handlers/index.js","webpack:///./server/mongoose-connection.js","webpack:///./server/passport.js","webpack:///./server/routes.js","webpack:///./server/services/socketio.js","webpack:///external \"http\"","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/controllers/_cartoon.js","webpack:///./server/controllers/cartoon.js","webpack:///./server/controllers/entry.js","webpack:///./server/controllers/user.js","webpack:///./server/handlers/checkUser.js","webpack:///./server/jwt.js","webpack:///./server/models/_cartoon.js","webpack:///./server/models/cartoon.js","webpack:///./server/models/entry.js","webpack:///external \"bcrypt\"","webpack:///external \"cloudinary\"","webpack:///external \"fs\"","webpack:///external \"koa-multer\"","webpack:///external \"koa-router\"","webpack:///external \"koa2-formidable\"","webpack:///external \"lodash\"","webpack:///external \"mongoose-unique-validator\"","webpack:///external \"os\"","webpack:///external \"passport-local\"","webpack:///external \"path\"","webpack:///external \"regenerator-runtime\"","webpack:///external \"sequelize-slugify\"","webpack:///external \"socket.io\"","webpack:///external \"util\"","webpack:///./server/index.js"],"names":["MONGO_URI","REDIS_URL","DATABASE_URL","process","env","MONGO_URL","REDIS_KEY","JWT_KEY","redisClient","redis","createClient","on","err","console","log","require","promisify","getAsync","get","bind","mongoose","plugin","userSchema","username","type","String","unique","required","role","default","email","password","pre","next","isModified","salt","bcrypt","genSaltSync","hashSync","methods","authenticate","compareSync","passwordHash","statics","done","findOne","user","model","genToken","data","expiration","jwt","sign","expiresIn","verify","token","verifyNoExp","ignoreExpiration","sequelize","dialect","sync","module","exports","head","title","meta","charset","name","content","hid","link","rel","href","plugins","src","ssr","css","lang","loading","color","build","vendor","extractCSS","extend","config","ctx","isClient","rules","push","enforce","test","loader","exclude","app","use","bodyParser","debug","Promise","mongoUri","Error","connect","then","mongodb","LocalStrategy","configure","passport","strategyFunc","User","serializeUser","id","deserializeUser","findById","fs","os","path","multer","upload","dest","cloudinary","cloud_name","api_key","api_secret","router","post","signUp","signIn","checkUser","body","Cartoon","add","getAll","_Cartoon","getCategoryCartoons","getRedis","getMongo","getCategories","getMoreCartoons","getCartoons","getTagByName","getCartoonBySlug","getCartoonsByTag","getTags","setTag","addCategory","addAgeCategory","addTag","getMultiseries","file","request","files","reader","createReadStream","stream","createWriteStream","join","pipe","uploader","image","secure_url","Entry","addEntry","server","io","socket","sockets","msg","_","Op","Sequelize","where","slug","params","cartoon","include","findAll","tag","category","cartoons","Tag","isMultiseries","multiseries","limit","order","offset","parseInt","ne","through","attributes","Categories","create","categories","group","raw","tags","setTags","find","map","_id","item","distinct","i","save","e","AgeCategory","set","toString","print","getOne","el","entry","status","jwtService","accessToken","refreshToken","login","response","header","authorization","decoded","throw","message","confirmedRefreshToken","newAccessToken","newRefreshToken","define","cartoonId","allowNull","primaryKey","STRING","description","TEXT","unclear","video","year","INTEGER","thumbnail","author","BOOLEAN","parentTitleId","autoIncrement","categoriesId","CartoonTags","tag_id","taggable","taggable_id","references","belongsTo","foreignKey","hasMany","belongsToMany","scope","constraints","SequelizeSlugify","slugifyModel","source","ageCategorySchema","tagSchema","cartoonSchema","Boolean","Number","multiseriesTitle","Schema","Types","ObjectId","ref","entrySchema","host","HOST","port","PORT","dev","nuxt","builder","initialize","initHandlers","mongooseConnector","catch","error","routes","resolve","reject","res","render","req","promise","http","createServer","callback","websockets","listen","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 45);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f8bf1967b17499046a72","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"debug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debug\"\n// module id = 1\n// module chunks = 0","let MONGO_URI, REDIS_URL, DATABASE_URL\n\nif (process.env.NODE_ENV === 'production') {\n\tMONGO_URI = process.env.MONGO_URL\n\tREDIS_URL = process.env.REDIS_URL\n\tDATABASE_URL = process.env.DATABASE_URL\n} else {\n\tMONGO_URI = 'mongodb://fiannafail:loOhdsdFom5nYCiR@cluster0-shard-00-00-y7wbs.mongodb.net:27017,cluster0-shard-00-01-y7wbs.mongodb.net:27017,cluster0-shard-00-02-y7wbs.mongodb.net:27017/test?ssl=true&replicaSet=Cluster0-shard-0&authSource=admin'\n\tREDIS_URL = 'redis://localhost:6379',\n\tDATABASE_URL = 'postgres://postgres:6354825107@127.0.0.1:5432/postgres'\n}\nconst REDIS_KEY = 'DRKlPeBHbgr0FUSs'\nconst JWT_KEY = 'dFTvn3RxVsXE8ZJafmcQSi7fSAL4L9i8'\n\nexport {\n\tMONGO_URI,\n\tREDIS_URL,\n\tJWT_KEY,\n\tREDIS_KEY,\n\tDATABASE_URL\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/config.js","import redis from 'redis'\nimport { REDIS_KEY, REDIS_URL } from '../config'\n\nexport const redisClient = redis.createClient(REDIS_URL);\n\nredisClient.on(\"error\", function (err) {\n    console.log(\"Error \" + err);\n});\n\nconst { promisify } = require('util');\nexport const getAsync = promisify(redisClient.get).bind(redisClient);\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/handlers/redis.js","import mongoose, { Schema } from 'mongoose'\nimport bcrypt from 'bcrypt'\nimport uniqueValidator from 'mongoose-unique-validator'\n\nmongoose.plugin(uniqueValidator)\n\nconst userSchema = new Schema({\n\tusername: { type: String, unique: true, required: true },\n\trole: { type: String, default: 'user', required: true },\n\temail: { type: String, unique: true, required: true },\n\tpassword: { type: String, required: true }\n})\n\nuserSchema.pre('save', function (next) {\n\tif (!this.isModified('password')) {\n\t\treturn next()\n\t}\n\tconst salt = bcrypt.genSaltSync(10)\n\n\tthis.password = bcrypt.hashSync(this.password, salt)\n\tnext()\n})\n\nuserSchema.methods.authenticate = function (password) {\n\treturn bcrypt.compareSync(password, this.passwordHash)\n}\nuserSchema.statics.authenticate = function (username, password, done) {\n\tconsole.log({ username: username, password: password })\n\tthis.findOne({ username: username }, (err, user) => {\n\t\tif (err) {\n\t\t\tconsole.log('Error to check', err)\n\t\t\tdone(err)\n\t\t} else if (user) {\n\t\t\tconsole.log('Success!', user)\n\t\t\tdone(null, user)\n\t\t} else {\n\t\t\tconsole.log('Something else')\n\t\t\tdone(null, false)\n\t\t}\n\t})\n}\n\nexport default mongoose.model('user', userSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"redis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redis\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"koa-passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-passport\"\n// module id = 7\n// module chunks = 0","import jwt from 'jsonwebtoken';\nimport { JWT_KEY } from '../config'\n\nexport default {\n  genToken(data, expiration) {\n    return jwt.sign(data, JWT_KEY, { expiresIn: expiration })\n  },\n  verify(token) {\n    return jwt.verify(token, JWT_KEY)\n  },\n  verifyNoExp(token) {\n    return jwt.verify(token, JWT_KEY, { ignoreExpiration: true })\n  }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/services/jwt-service.js","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 9\n// module chunks = 0","import Sequalize from 'sequelize'\nimport { DATABASE_URL } from './config'\n\nconst sequelize = new Sequalize(DATABASE_URL, {\n\tdialect: 'postgres'\n})\nsequelize.sync()\nexport default sequelize\n\n\n\n// WEBPACK FOOTER //\n// ./server/postgres-connector.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 11\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'starter',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n      { rel: 'stylesheet', href: 'https://fonts.googleapis.com/css?family=Material+Icons|Roboto+Mono:500|Source+Sans+Pro:300,400,600,700&amp;subset=cyrillic' }\n    ]\n  },\n  plugins: [\n    { src: '~/plugins/vue-notifications.js', ssr: false },\n    { src: '~/plugins/vue-lazyload.js', ssr: false }\n  ],\n  /*\n  ** Global CSS\n  */\n  css: ['~assets/css/main.css', { src: '~assets/css/app.styl', lang: 'stylus' }],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#3B8070' },\n  /*\n   ** Build configuration\n   */\n  build: {\n    vendor: ['vue-notifications'],\n    extractCSS: true,\n    /*\n     ** Run ESLINT on save\n     */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.js$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/,\n      },{\n          enforce: 'pre',\n          test: /\\.vue$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/,\n      })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import bodyParser from 'koa2-formidable'\n\nexport default (app) => {\n  app.use(bodyParser());\n}\n\n\n// WEBPACK FOOTER //\n// ./server/handlers/index.js","import mongoose from 'mongoose'\nconst debug = require('debug')('app:nuxt')\n\nmongoose.Promise = Promise\n\nexport default (mongoUri) => {\n\tif (!mongoUri) {\n\t\tthrow Error('Mongo uri is undefinded')\n\t}\n\treturn mongoose\n\t\t.connect(mongoUri)\n\t\t.then((mongodb) => {\n\t\t\tdebug('Mongo connected')\n\n\t\t\treturn mongodb\n\t\t})\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/mongoose-connection.js","import passport from 'koa-passport'\nconst LocalStrategy = require('passport-local');\nimport User from './models/user'\n\nconst debug = require('debug')('app:nuxt')\n\nfunction configure(passport) {\n\tconst strategyFunc = function (username, password, done) {\n\t\tUser.authenticate(username, password, function (err, user) {\n\t\t\tif (err) {\n\t\t\t\tconsole.log(err)\n\t\t\t\tdone(err)\n\t\t\t} else if (user) {\n\t\t\t\tconsole.log('Local - Success')\n\t\t\t\tdone(null, user)\n\t\t\t} else {\n\t\t\t\tconsole.log(err)\n\t\t\t\tdone(null, false)\n\t\t\t}\n\t\t})\n\t}\n\tpassport.use(new LocalStrategy(strategyFunc))\n\n\tpassport.serializeUser(function (user, done) {\n\t\tdone(null, user.id)\n\t})\n\tpassport.deserializeUser(function (id, done) {\n\t\tUser.findById(id, function (err, user) {\n\t\t\tdone(err, user)\n\t\t})\n\t})\n}\n\nmodule.exports = {\n\tconfigure\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/passport.js","import Router from 'koa-router'\nconst debug = require('debug')('app:nuxt')\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst multer = require('koa-multer');\nconst upload = multer({ dest: 'uploads/' });\n\nvar cloudinary = require('cloudinary');\n\ncloudinary.config({ \n\tcloud_name: 'rastibolshoi', \n\tapi_key: '374329698237239', \n\tapi_secret: 'Kax6e6xy_FakEfMUc61P_3XUS_I' \n});\n\nimport User from './controllers/user'\nimport Entry from './controllers/entry'\nimport Cartoon from './controllers/cartoon'\n\nimport _Cartoon from './controllers/_cartoon'\n\nimport checkUser from './handlers/checkUser'\nimport putToken from './jwt'\n\nconst router = new Router()\n\nrouter.post('/user', User.signUp)\nrouter.post('/login', User.signIn)\n//\trouter.get('/admin', putToken(), checkUser())\nrouter.get('/custom',\n\tcheckUser(),\n\tasync (ctx, next) => {\n\t\tctx.body = 'Hello!'\n\t\tdebug('page rendered')\n\t})\n\nrouter.post('/addcartoon', Cartoon.add)\nrouter.get('/getcartoons', Cartoon.getAll)\nrouter.get('/api/cartoons/:slug', _Cartoon.getCategoryCartoons)\n//\trouter.get('/cartoon/:slug', Cartoon.getOne)\nrouter.get('/redis', Cartoon.getRedis)\nrouter.get('/mongo', Cartoon.getMongo)\nrouter.get('/getcats', Cartoon.getCategories)\nrouter.get('/getcategories', _Cartoon.getCategories)\nrouter.get('/api/cartoons/page/:id/:category', _Cartoon.getMoreCartoons)\nrouter.get('/api/cartoons', _Cartoon.getCartoons)\nrouter.get('/api/gettagbyname/:category/:tag', _Cartoon.getTagByName)\nrouter.get('/api/getcartoonbyslug/:cartoon', _Cartoon.getCartoonBySlug)\nrouter.get('/api/getcartoonsbytag/:tag', _Cartoon.getCartoonsByTag)\nrouter.get('/gettags', _Cartoon.getTags)\nrouter.post('/settag', _Cartoon.setTag)\nrouter.post('/add', _Cartoon.add)\nrouter.post('/addcategory', _Cartoon.addCategory)\nrouter.post('/addcat', Cartoon.addAgeCategory)\nrouter.post('/addtag', Cartoon.addTag)\nrouter.get('/getmultiseries', _Cartoon.getMultiseries)\nrouter.post('/up', async (ctx, next) => {\n\tconst file = ctx.request.files.file\n\tconst reader = fs.createReadStream(file.path)\n\tconst stream = fs.createWriteStream(path.join('./uploads', file.name))\n\treader.pipe(stream)\n\tconsole.log('uploading %s -> %s', file.name, stream.path)\n})\nrouter.post('/upload', async (ctx, next) => {\n\tconst file = ctx.request.files.file.path\n\tconst image = await cloudinary.uploader.upload(file)\n\tconsole.log(image.secure_url) \n\tctx.body = image.secure_url\n})\n// Entries routes\nrouter.post('/addentry', Entry.addEntry)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes.js","\nimport socket from 'socket.io'\n\n\nexport default (server) => {\n\nconst io = socket(server)\n\nio.sockets.on('connection', (socket) => {\n    console.log('a user connected')\n    socket.on('send-message', (msg) => {\n      console.log(msg)\n    })\n    socket.on('disconnect', () => {\n      console.log('user disconnected')\n    })\n  })\n}\t\n\n\n\n// WEBPACK FOOTER //\n// ./server/services/socketio.js","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 20\n// module chunks = 0","import Sequelize from 'sequelize'\nvar _ = require('lodash')\nimport { Cartoon, Tag, Categories } from '../models/_cartoon'\nconst Op = Sequelize.Op\n\nexport default {\n\tgetCartoonBySlug: async(ctx, next) => {\n\t\ttry {\n\t\t\tconst cartoon = await Cartoon.findOne({\n\t\t\t\twhere: {\n\t\t\t\t\tslug: ctx.params.cartoon\n\t\t\t\t},\n\t\t\t\tinclude: [Tag, Categories]\n\t\t\t})\n\t\t\tctx.body = cartoon\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetTagByName: async(ctx, next) => {\n\t\ttry {\n\t\t\tconst cartoons = await Cartoon.findAll({\n\t\t\t\tinclude:[{\n\t\t\t\t\tmodel: Tag,\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tname: ctx.params.tag\n\t\t\t\t\t}\n\n\t\t\t\t}, {\n\t\t\t\t\tmodel: Categories,\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tslug: ctx.params.category\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t})\n\t\t\tctx.body = cartoons\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetCartoonsByTag: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst cartoons = await Tag.findOne({\n\t\t\t\twhere: {\n\t\t\t\t\tname: ctx.params.tag\n\t\t\t\t},\n\t\t\t\tinclude: [{\n\t\t\t\t\tmodel: Cartoon,\n\t\t\t\t\tinclude: [{\n\t\t\t\t\t\tmodel: Tag\n\t\t\t\t\t}]\n\t\t\t\t}]\n\t\t\t})\n\t\t\tctx.body = cartoons\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetMultiseries: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst multiseries = await Cartoon.findAll({\n\t\t\t\twhere: { isMultiseries: true }\n\t\t\t})\n\t\t\tctx.body = multiseries\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetCategoryCartoons: async (ctx, next) => {\n\t\tconst limit = 5\n\t\ttry {\n\t\t\tconst category = await Cartoon.findAll({\n\t\t\t\tlimit: limit,\n\t\t\t\torder: [['createdAt', 'DESC']],\n\t\t\t\twhere: { isMultiseries: true },\n\t\t\t\tinclude: [{\n\t\t\t\t\tmodel: Categories,\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tslug: ctx.params.slug\n\t\t\t\t\t}\n\t\t\t\t}, Tag]\n\t\t\t})\n\t\t\tctx.body = category\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetMoreCartoons: async (ctx, next) => {\n\t\tconst limit = 5\n\t\tconst offset = parseInt(ctx.params.id)\n\t\tconst category = ctx.params.category !== 'undefined' ? ctx.params.category : { [Op.ne]: null }\n\t\tconsole.log(category)\n\t\tconst cartoons = await Cartoon.findAll({\n\t\t\toffset: offset * limit,\n\t\t\tlimit: limit,\n\t\t\torder: [['createdAt', 'DESC']],\n\t\t\tinclude: [{\n\t\t\t\tmodel: Tag,\n\t\t\t\tthrough: {\n\t\t\t\t\tattributes: ['tag_id']\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tmodel: Categories,\n\t\t\t\twhere: {\n\t\t\t\t\tslug: category\n\t\t\t\t}\n\t\t\t}]\n\t\t})\n\t\tctx.body = cartoons\n\t},\n\tgetCartoons: async (ctx, next) => {\n\t\tconst cartoons = await Cartoon.findAll({\n\t\t\tlimit: 5,\n\t\t\torder: [['createdAt', 'DESC']],\n\t\t\twhere: {\n\t\t\t\tisMultiseries: true\n\t\t\t},\n\t\t\tinclude: [{\n\t\t\t\tmodel: Tag,\n\t\t\t\tthrough: {\n\t\t\t\t\tattributes: ['tag_id']\n\t\t\t\t}\n\t\t\t}, Categories]\n\t\t})\n\t\tctx.body = cartoons\n\t},\n\taddCategory: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst categories = await Categories.create(ctx.request.body)\n\t\t\tctx.body = categories\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetCategories: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst categories = await Categories.findAll(\n\t\t\t\t{ order: ['createdAt'] }\n\t\t\t)\n\t\t\tctx.body = categories\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetTags: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst tags = await Tag.findAll({\n\t\t\t\tattributes: ['name'],\n\t\t\t\tgroup: ['name'],\n\t\t\t\traw: true\n\t\t\t})\n\t\t\tctx.body = tags\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tadd: async (ctx, next) => {\n\t\tconst cartoon = await Cartoon.create(ctx.request.body, {\n\t\t\tinclude: [Tag, Categories]\n\t\t})\n\t\tctx.body = cartoon\n\t},\n\tsetTag: async (ctx, next) => {\n\t\tconst tag = await Cartoon.setTags(['tag1', 'tag2'])\n\t\tctx.body = tag\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/_cartoon.js","import redis from 'redis'\nimport { Cartoon, AgeCategory, Tag } from '../models/cartoon'\nconst debug = require('debug')('app:nuxt')\nimport { redisClient, getAsync } from '../handlers/redis'\n\nexport default {\n\tgetMultiseries: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst multiseries = await Cartoon.find({ isMultiseries: true })\n\t\t\tctx.body = multiseries.map(item => {\n\t\t\t\treturn {\n\t\t\t\t\t_id: item._id,\n\t\t\t\t\ttitle: item.title\n\t\t\t\t}\n\t\t\t})\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetTags: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst tags = await Tag.find().distinct('_id')\n\t\t\tctx.body = tags\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\taddTag: async (ctx, next) => {\n\t\tlet tags = []\n\t\ttry {\n\t\t\tfor (let i in ctx.request.body) {\n\t\t\t\ttags.push({ name:  ctx.request.body[i]})\n\t\t\t}\n\t\t\tconsole.log(tags)\n\t\t\tconst tag = await Tag.create(tags)\n\t\t\tctx.body = tag\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\taddAgeCategory: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst category = new AgeCategory(ctx.request.body)\n\t\t\t\t// name: 'half',\n\t\t\t\t// slug: 'half',\n\t\t\t\t// description: 'halfdesc'\n\t\t\tcategory.save()\n\t\t\tctx.body = category\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetCategories: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst categories = await AgeCategory.find()\n\t\t\tctx.body = categories\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tadd: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst cartoon = await new Cartoon(ctx.request.body)\n\t\t\tcartoon.save()\n\t\t\tctx.body = cartoon\n\t\t\tawait redisClient.set(`cartoon`, cartoon._id.toString(), redis.print);\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t},\n\tgetAll: async (ctx, next) => {\n\t\tdebug('start getting')\n\t\tconst cartoons = await Cartoon.find({})\n\t\tif (cartoons) {\n\t\t\tctx.body = cartoons\n\t\t} else {\n\t\t\tctx.body = 'Nothing was found'\n\t\t}\t\n\t\tdebug('finish getting')\n\t},\n\tgetOne: async (ctx, next) => {\n\t\tconst cartoon = await Cartoon.find({ slug: ctx.params.slug })\n\t\tctx.body = cartoon\n\t},\n\tgetRedis: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst el = await getAsync(`cartoon`)\n\t\t\tctx.body = el\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t\tctx.body = e\n\t\t}\n\t},\n\tgetMongo: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst cartoon = await Cartoon.find({ _id: '5a74e75c180fa800bba8fe3e' })\n\t\t\tctx.body = cartoon\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t\tctx.body = e\n\t\t}\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/cartoon.js","import { Entry } from '../models/entry'\nexport default {\n\taddEntry: async (ctx, next) => {\n\t\ttry {\n\t\t\tconst entry = new Entry(ctx.request.body)\n\t\t\tentry.save()\n\t\t\tctx.body = entry\n\t\t} catch (e) {\n\t\t\tconsole.log(e)\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/entry.js","import redis from 'redis'\nimport passport from 'koa-passport'\nimport User from '../models/user'\nimport jwtService from '../services/jwt-service';\nimport { redisClient, getAsync } from '../handlers/redis'\n\nexport default {\n\tsignUp: async (ctx, next) => {\n\t\tconsole.log(ctx.request.body)\n\t\ttry {\n\t\t\tconst user = await new User(ctx.request.body)\n\t\t\tawait user.save()\n\t\t\tctx.body = user\n\t\t}\n\t\tcatch (err) {\n\t\t\tctx.status = 400;\n\t\t\tctx.body = err\n\t\t\tconsole.log(err)\n\t\t}\n\t},\n\tsignIn: async (ctx, next) => {\n\t\tawait passport.authenticate('local', async (err, user) => {\n\t\t\tconst { email, password } = ctx.request.body;\n\t\t\tif (user == false) {\n\t\t\t\tctx.body = \"Login failed\"\n\t\t\t} else {\n\t\t\t\tconst accessToken = await jwtService.genToken({ id: user._id, username: user.username }, '2m')\n\t\t\t\tconst refreshToken = await jwtService.genToken({ username: user.username }, '30d')\n\t\t\t\tctx.body = { \n\t\t\t\t\taccessToken: accessToken,\n\t\t\t\t\trefreshToken: refreshToken\n\t\t\t\t}\n\t\t\t\tawait redisClient.set(`token_${user.username}`, accessToken, redis.print);\n\t\t\t\tawait redisClient.set(`refreshToken${user.username}`, refreshToken, redis.print);\n\t\t\t\treturn ctx.login(user)\n\t\t\t}\n\t\t})(ctx, next)\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/user.js","import redis from 'redis'\nimport jwtService from '../services/jwt-service'\nimport User from '../models/user'\nimport { redisClient, getAsync } from '../handlers/redis'\n\nconst debug = require('debug')('app:nuxt')\n\nexport default () => async (ctx, next) => {\n\tdebug('token has not recieved')\n\tconst token = ctx.response.header.authorization\n\tlet decoded = null\n\tif (!token) {\n\t\tctx.throw(403, { message: 'Unauth' })\n\t}\n\ttry {\n\t\tdecoded = await jwtService.verify(token)\n\t} catch (e) {\n\t\tconst refreshToken = ctx.response.header['refresh-token']\n\t\tdecoded = await jwtService.verifyNoExp(token)\n\t\tconst confirmedRefreshToken = await getAsync(`refreshToken${decoded.username}`)\n\t\tif (e.name === 'TokenExpiredError' && confirmedRefreshToken === refreshToken) {\n\t\t\tconst newAccessToken = await jwtService.genToken({ id: decoded._id, username: decoded.username }, '2m')\n\t\t\tconst newRefreshToken = await jwtService.genToken({ username: decoded.username }, '30d')\n\t\t\tawait redisClient.set(`token_${decoded.username}`, newAccessToken, redis.print);\n\t\t\tawait redisClient.set(`refreshToken${decoded.username}`, newRefreshToken, redis.print);\n\t\t}\n\t}\n\tdebug('token recieved')\n\ttry {\n\t\tconst user = await User.findOne({ username: decoded.username })\n\t\tdebug('user found', user)\n\t\tnext()\n\t} catch (e) {\n\t\tctx.throw(403, { message: 'Unauth' })\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./server/handlers/checkUser.js","import jwtService from './services/jwt-service'\nimport jwt from 'jsonwebtoken'\n\nimport { redisClient, getAsync } from './handlers/redis'\nimport User from './models/user'\n\nconst debug = require('debug')('app:nuxt')\n\nexport default () => async (ctx, next) => {\n\tdebug('jwt start')\n\tconst { authorization } = ctx.request.header\n\tif (!authorization) {\n\t\tconsole.log('next')\n\t\treturn await next()\n\t}\n\tconst { username } = await jwtService.verify(authorization)\n\tdebug('refresh token verified')\n\ttry {\n\t\tconst token = await getAsync(`token_${username}`)\n\t\tctx.set('Authorization', token)\n\t\tctx.set('Refresh-Token', authorization)\n\t\tdebug('jwt access token recieved')\n\t} catch (e) {\n\t\tctx.throw(401, { message: 'Unauthorized. Invalid Token' })\n\t}\n\tawait next()\n}\n\n\n// WEBPACK FOOTER //\n// ./server/jwt.js","import Sequelize from 'sequelize'\nimport SequelizeSlugify from 'sequelize-slugify'\nimport sequelize from '../postgres-connector'\n\nconst Cartoon = sequelize.define('cartoon', {\n\tcartoonId: { \n\t\tallowNull: false,\n\t\tprimaryKey: true,\n\t\ttype: Sequelize.STRING\n\t},\n\tslug: {\n\t\ttype: Sequelize.STRING,\n\t\tunique: true\n\t},\n\ttitle: Sequelize.STRING,\n\tdescription: Sequelize.TEXT,\n\tunclear: Sequelize.TEXT,\n\tvideo: Sequelize.STRING,\n\tyear: Sequelize.INTEGER,\n\tthumbnail: Sequelize.STRING,\n\tauthor: Sequelize.STRING,\n\tisMultiseries: Sequelize.BOOLEAN,\n\tparentTitleId: Sequelize.STRING\n})\n\nconst Tag = sequelize.define('tags', {\n\tid: {\n\t\ttype: Sequelize.INTEGER,\n\t\tprimaryKey: true,\n\t\tautoIncrement: true\n\t},\n\tname: {\n\t\ttype: Sequelize.STRING\n\t},\n\tslug: {\n\t\ttype: Sequelize.STRING\n\t},\n\tdescription: Sequelize.TEXT\n})\n\nconst Categories = sequelize.define('categories', {\n\tcategoriesId: { \n\t\tprimaryKey: true,\n\t\tautoIncrement: true,\n\t\ttype: Sequelize.INTEGER\n\t},\n\tname: {\n\t\ttype: Sequelize.STRING\n\t},\n\tslug: {\n\t\ttype: Sequelize.STRING,\n\t\tunique: true\n\t},\n\tdescription: Sequelize.TEXT\n})\n\nvar CartoonTags = sequelize.define('cartoontags', {\n\tid : {\n\t\ttype: Sequelize.INTEGER,\n\t\tprimaryKey: true,\n\t\tautoIncrement: true\n\t},\n\ttag_id: {\n\t\ttype: Sequelize.INTEGER,\n\t\tunique: 'item_tag_taggable'\n\t},\n\ttaggable: {\n\t\ttype: Sequelize.STRING,\n\t\tunique: 'item_tag_taggable'\n\t},\n\ttaggable_id: {\n\t\ttype: Sequelize.INTEGER,\n\t\tunique: 'item_tag_taggable',\n\t\treferences: null\n\t}\n})\n\nCartoon.belongsTo(Categories, { foreignKey: 'categoriesId' })\nCategories.hasMany(Cartoon, { foreignKey: 'categoriesId' })\n\nCartoon.belongsToMany(Tag, {\n\tthrough: {\n\t\tmodel: CartoonTags,\n\t\tunique: false,\n\t\tscope: {\n\t\t\ttaggable: 'cartoon'\n\t\t}\n\t},\n\tforeignKey: 'taggable_id',\n\tconstraints: false\n})\nTag.belongsToMany(Cartoon, { \n\tthrough: {\n\t\tmodel: CartoonTags,\n\t\tunique: false\n\t},\n\tforeignKey: 'tag_id',\n\tconstraints: false\n})\nSequelizeSlugify.slugifyModel(Categories, {\n\tsource: ['name']\n})\nSequelizeSlugify.slugifyModel(Cartoon, {\n\tsource: ['title']\n})\nSequelizeSlugify.slugifyModel(Tag, {\n\tsource: ['name']\n})\nexport {\n\tCartoon,\n\tTag,\n\tCartoonTags,\n\tCategories\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/_cartoon.js","import mongoose, { Schema } from 'mongoose'\n\nconst ageCategorySchema = new Schema({\n\tname: String,\n\tslug: String,\n\tdescription: String\n})\nconst tagSchema = new Schema({\n\tname: { type: String }\n})\n\nconst cartoonSchema = new Schema({\n\ttitle: { type: String },\n\tslug: { type: String },\n\tisMultiseries: { type: Boolean },\n\tthumbnail: { type: String },\n\tyear: { type: Number },\n\tvideo: { type: String },\n\tmultiseriesTitle: { type: Schema.Types.ObjectId },\n\ttags: { type: [Schema.Types.ObjectId], ref: 'Tag' },\n\tauthor: { type: String },\n\tunclear: { type: String },\n\tdescription: { type: String },\n\tcategory: { type: Schema.Types.ObjectId, ref: 'AgeCategory' }\n})\n\nexport const Tag = mongoose.model('Tag', tagSchema, 'Tags')\nexport const Cartoon = mongoose.model('Cartoon', cartoonSchema, 'Cartoons')\nexport const AgeCategory = mongoose.model('AgeCategory', ageCategorySchema, 'Categories')\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/cartoon.js","import mongoose, { Schema } from 'mongoose'\n\nconst entrySchema = new Schema({\n\ttitle: { type: String },\n\tthumbnail: { type: String },\n\tcategory: { type: String },\n\tcontent: { type: String },\n\tslug: { type: String }\n})\n\nexport const Entry = mongoose.model('Entry', entrySchema, 'Entries')\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/entry.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"cloudinary\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cloudinary\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"koa-multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-multer\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"koa2-formidable\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-formidable\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"mongoose-unique-validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-unique-validator\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"os\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"os\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 39\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 40\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 41\n// module chunks = 0","module.exports = require(\"sequelize-slugify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize-slugify\"\n// module id = 42\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 43\n// module chunks = 0","module.exports = require(\"util\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"util\"\n// module id = 44\n// module chunks = 0","import Koa from 'koa'\nimport http from 'http'\nimport { Nuxt, Builder } from 'nuxt'\nimport passport from 'koa-passport'\nimport router from './routes'\nconst debug = require('debug')('app:nuxt')\nimport mongooseConnector from './mongoose-connection'\nimport initHandlers from './handlers'\nimport { MONGO_URI } from './config'\nimport websockets from './services/socketio'\nimport sequelize from './postgres-connector'\n\nasync function start () {\n\tconst app = new Koa()\n\tconst host = process.env.HOST || '127.0.0.1'\n\tconst port = process.env.PORT || 3000\n\n\t// Import and Set Nuxt.js options\n\tlet config = require('../nuxt.config.js')\n\tconfig.dev = !(app.env === 'production')\n\n\t// Instantiate nuxt.js\n\tconst nuxt = new Nuxt(config)\n\n\t// Build in development\n\tif (config.dev) {\n\t\tconst builder = new Builder(nuxt)\n\t\tawait builder.build()\n\t}\n\t//  Passport\n\tapp.use(passport.initialize())\n\trequire('./passport').configure(passport)\n\n\t// Initial handlers\n\tinitHandlers(app)\n\n\t// JWT Handler\n\t//  app.use(jwtHandler())\n\n\t// Mongoose\n\tmongooseConnector(MONGO_URI)\n\n\t// Postgres / Sequelize\n\tsequelize\n\t.authenticate()\n\t.then(() => {\n\t\tconsole.log('Connection has been established successfully.')\n\t})\n\t.catch(err => {\n\t\tconsole.error('Unable to connect to the database:', err)\n\t})\n\n\t// Router\n\tapp.use(async (ctx, next) => {\n\t\tawait router.routes()(ctx, next)\n\t})\n\n\tapp.use(async (ctx, next) => {\n\t\tawait next()\n\t\tctx.status = 200 // koa defaults to 404 when it sees that status is unset\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tctx.res.on('close', resolve)\n\t\t\tctx.res.on('finish', resolve)\n\t\t\tnuxt.render(ctx.req, ctx.res, promise => {\n\t\t\t// nuxt.render passes a rejected promise into callback on error.\n\t\t\t\tpromise.then(resolve).catch(reject)\n\t\t\t})\n\t\t})\n\t})\n\n\t// socket.io\n\tconst server = http.createServer(app.callback())\n\twebsockets(server)\n\n\t// listen\n\tserver.listen(port, host)\n\tdebug('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}